{"dependencies":[{"name":"../utils.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":11,"column":19,"index":404},"end":{"line":11,"column":41,"index":426}}],"key":"Yc7DmwhweSDBIC4bv+r2fO8xp6U=","exportNames":["*"]}},{"name":"./modular.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":12,"column":21,"index":449},"end":{"line":12,"column":44,"index":472}}],"key":"pkHxIsiyj9LvPZma2E+OjOIbg7k=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,e,d){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.montgomery=function(y){const B=s(y),{P:l,type:f,adjustScalarBytes:I,powPminus2:_,randomBytes:b}=B,x='x25519'===f;if(!x&&'x448'!==f)throw new Error('invalid type');const p=b||t.randomBytes,v=x?255:448,K=x?32:56,w=x?BigInt(9):BigInt(5),P=x?BigInt(121665):BigInt(39081),j=x?u**BigInt(254):u**BigInt(447),E=x?BigInt(8)*u**BigInt(251)-c:BigInt(4)*u**BigInt(445)-c,S=j+E+c,h=t=>(0,n.mod)(t,l),L=M(w);function M(n){return(0,t.numberToBytesLE)(h(n),K)}function O(n){const o=(0,t.ensureBytes)('u coordinate',n,K);return x&&(o[31]&=127),h((0,t.bytesToNumberLE)(o))}function T(n){return(0,t.bytesToNumberLE)(I((0,t.ensureBytes)('scalar',n,K)))}function k(t,n){const c=z(O(n),T(t));if(c===o)throw new Error('invalid private or public key received');return M(c)}function N(t){return k(t,L)}function R(t,n,o){const c=h(t*(n-o));return{x_2:n=h(n-c),x_3:o=h(o+c)}}function z(n,u){(0,t.aInRange)('u',n,o,l),(0,t.aInRange)('scalar',u,j,S);const s=u,y=n;let B=c,f=o,I=n,b=c,x=o;for(let t=BigInt(v-1);t>=o;t--){const n=s>>t&c;x^=n,({x_2:B,x_3:I}=R(x,B,I)),({x_2:f,x_3:b}=R(x,f,b)),x=n;const o=B+f,u=h(o*o),l=B-f,_=h(l*l),p=u-_,v=I+b,K=h((I-b)*o),w=h(v*l),j=K+w,E=K-w;I=h(j*j),b=h(y*h(E*E)),B=h(u*_),f=h(p*(u+h(P*p)))}({x_2:B,x_3:I}=R(x,B,I)),({x_2:f,x_3:b}=R(x,f,b));const p=_(f);return h(B*p)}const G={secretKey:K,publicKey:K,seed:K},q=(n=p(K))=>((0,t.abytes)(n,G.seed),n);return{keygen:function(t){const n=q(t);return{secretKey:n,publicKey:N(n)}},getSharedSecret:(t,n)=>k(t,n),getPublicKey:t=>N(t),scalarMult:k,scalarMultBase:N,utils:{randomSecretKey:q,randomPrivateKey:q},GuBytes:L.slice(),lengths:G}};\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nconst t=r(d[0]),n=r(d[1]),o=BigInt(0),c=BigInt(1),u=BigInt(2);function s(n){return(0,t._validateObject)(n,{adjustScalarBytes:'function',powPminus2:'function'}),Object.freeze({...n})}});","lineCount":3,"map":[[1,28,1,0],[1,41,2,0,"Object"],[1,48,2,7,"defineProperty"],[1,63,2,22,"exports"],[1,65,2,31],[1,78,2,45],[1,79,2,47,"value"],[1,86,2,54],[1,90,3,0,"exports"],[1,92,3,8,"montgomery"],[1,103,23,0],[1,112,23,20,"curveDef"],[1,115,24,4],[1,121,24,10,"CURVE"],[1,123,24,18,"validateOpts"],[1,125,24,31,"curveDef"],[1,129,25,10,"P"],[1,131,25,12,"P"],[1,133,25,13,"type"],[1,138,25,15,"type"],[1,140,25,19,"adjustScalarBytes"],[1,158,25,21,"adjustScalarBytes"],[1,160,25,38,"powPminus2"],[1,171,25,40,"powPminus2"],[1,173,25,52,"randomBytes"],[1,185,25,65,"rand"],[1,188,25,74,"CURVE"],[1,190,26,10,"is25519"],[1,192,26,29],[1,203,26,20,"type"],[1,205,27,4],[1,209,27,9,"is25519"],[1,212,27,29],[1,221,27,20,"type"],[1,223,28,8],[1,229,28,14],[1,233,28,18,"Error"],[1,239,28,24],[1,255,29,4],[1,261,29,10,"randomBytes_"],[1,263,29,25,"rand"],[1,266,29,33,"utils_ts_1"],[1,268,29,44,"randomBytes"],[1,280,30,10,"montgomeryBits"],[1,282,30,27,"is25519"],[1,284,30,37],[1,288,30,43],[1,292,31,10,"fieldLen"],[1,294,31,21,"is25519"],[1,296,31,31],[1,299,31,36],[1,302,32,10,"Gu"],[1,304,32,15,"is25519"],[1,306,32,25,"BigInt"],[1,313,32,32],[1,316,32,37,"BigInt"],[1,323,32,44],[1,326,37,10,"a24"],[1,328,37,16,"is25519"],[1,330,37,26,"BigInt"],[1,337,37,33],[1,345,37,43,"BigInt"],[1,352,37,50],[1,359,41,10,"minScalar"],[1,361,41,22,"is25519"],[1,363,41,32,"_2n"],[1,366,41,39,"BigInt"],[1,373,41,46],[1,378,41,53,"_2n"],[1,381,41,60,"BigInt"],[1,388,41,67],[1,393,42,10,"maxAdded"],[1,395,42,21,"is25519"],[1,397,43,10,"BigInt"],[1,404,43,17],[1,407,43,22,"_2n"],[1,410,43,29,"BigInt"],[1,417,43,36],[1,422,43,43,"_1n"],[1,424,44,10,"BigInt"],[1,431,44,17],[1,434,44,22,"_2n"],[1,437,44,29,"BigInt"],[1,444,44,36],[1,449,44,43,"_1n"],[1,451,45,10,"maxScalar"],[1,453,45,22,"minScalar"],[1,455,45,34,"maxAdded"],[1,457,45,45,"_1n"],[1,459,46,10,"modP"],[1,461,46,18,"n"],[1,465,46,24],[1,467,46,28,"modular_ts_1"],[1,469,46,41,"mod"],[1,474,46,46,"n"],[1,476,46,49,"P"],[1,479,47,10,"GuBytes"],[1,481,47,20,"encodeU"],[1,483,47,28,"Gu"],[1,486,48,4],[1,495,48,13,"encodeU"],[1,497,48,21,"u"],[1,500,49,8],[1,507,49,15],[1,509,49,19,"utils_ts_1"],[1,511,49,30,"numberToBytesLE"],[1,528,49,47,"modP"],[1,530,49,52,"u"],[1,533,49,56,"fieldLen"],[1,535,50,4],[1,536,51,4],[1,545,51,13,"decodeU"],[1,547,51,21,"u"],[1,550,52,8],[1,556,52,14,"_u"],[1,559,52,19],[1,561,52,23,"utils_ts_1"],[1,563,52,34,"ensureBytes"],[1,576,52,47],[1,591,52,63,"u"],[1,593,52,66,"fieldLen"],[1,596,61,8],[1,603,55,12,"is25519"],[1,607,56,12,"_u"],[1,609,56,15],[1,614,56,22],[1,619,61,15,"modP"],[1,622,61,20],[1,624,61,24,"utils_ts_1"],[1,626,61,35,"bytesToNumberLE"],[1,643,61,52,"_u"],[1,646,62,4],[1,647,63,4],[1,656,63,13,"decodeScalar"],[1,658,63,26,"scalar"],[1,661,64,8],[1,668,64,15],[1,670,64,19,"utils_ts_1"],[1,672,64,30,"bytesToNumberLE"],[1,689,64,47,"adjustScalarBytes"],[1,692,64,65],[1,694,64,69,"utils_ts_1"],[1,696,64,80,"ensureBytes"],[1,709,64,93],[1,718,64,103,"scalar"],[1,720,64,111,"fieldLen"],[1,724,65,4],[1,725,66,4],[1,734,66,13,"scalarMult"],[1,736,66,24,"scalar"],[1,738,66,32,"u"],[1,741,67,8],[1,747,67,14,"pu"],[1,749,67,19,"montgomeryLadder"],[1,751,67,36,"decodeU"],[1,753,67,44,"u"],[1,756,67,48,"decodeScalar"],[1,758,67,61,"scalar"],[1,762,71,8],[1,765,71,12,"pu"],[1,769,71,19,"_0n"],[1,771,72,12],[1,777,72,18],[1,781,72,22,"Error"],[1,787,72,28],[1,829,73,8],[1,836,73,15,"encodeU"],[1,838,73,23,"pu"],[1,840,74,4],[1,841,76,4],[1,850,76,13,"scalarMultBase"],[1,852,76,28,"scalar"],[1,855,77,8],[1,862,77,15,"scalarMult"],[1,864,77,26,"scalar"],[1,866,77,34,"GuBytes"],[1,868,78,4],[1,869,80,4],[1,878,80,13,"cswap"],[1,880,80,19,"swap"],[1,882,80,25,"x_2"],[1,884,80,30,"x_3"],[1,887,84,8],[1,893,84,14,"dummy"],[1,895,84,22,"modP"],[1,897,84,27,"swap"],[1,900,84,35,"x_2"],[1,902,84,41,"x_3"],[1,906,87,8],[1,912,87,15],[1,913,87,17,"x_2"],[1,917,85,8,"x_2"],[1,919,85,14,"modP"],[1,921,85,19,"x_2"],[1,923,85,25,"dummy"],[1,926,87,22,"x_3"],[1,930,86,8,"x_3"],[1,932,86,14,"modP"],[1,934,86,19,"x_3"],[1,936,86,25,"dummy"],[1,939,88,4],[1,940,95,4],[1,949,95,13,"montgomeryLadder"],[1,951,95,30,"u"],[1,953,95,33,"scalar"],[1,957,96,8],[1,959,96,12,"utils_ts_1"],[1,961,96,23,"aInRange"],[1,971,96,33],[1,975,96,38,"u"],[1,977,96,41,"_0n"],[1,979,96,46,"P"],[1,983,97,8],[1,985,97,12,"utils_ts_1"],[1,987,97,23,"aInRange"],[1,997,97,33],[1,1006,97,43,"scalar"],[1,1008,97,51,"minScalar"],[1,1010,97,62,"maxScalar"],[1,1013,98,8],[1,1019,98,14,"k"],[1,1021,98,18,"scalar"],[1,1023,99,14,"x_1"],[1,1025,99,20,"u"],[1,1027,100,8],[1,1031,100,12,"x_2"],[1,1033,100,18,"_1n"],[1,1035,101,12,"z_2"],[1,1037,101,18,"_0n"],[1,1039,102,12,"x_3"],[1,1041,102,18,"u"],[1,1043,103,12,"z_3"],[1,1045,103,18,"_1n"],[1,1047,104,12,"swap"],[1,1049,104,19,"_0n"],[1,1051,105,8],[1,1055,105,13],[1,1059,105,17,"t"],[1,1061,105,21,"BigInt"],[1,1068,105,28,"montgomeryBits"],[1,1070,105,45],[1,1073,105,49,"t"],[1,1076,105,54,"_0n"],[1,1078,105,59,"t"],[1,1082,105,64],[1,1083,106,12],[1,1089,106,18,"k_t"],[1,1091,106,25,"k"],[1,1094,106,30,"t"],[1,1096,106,35,"_1n"],[1,1098,107,12,"swap"],[1,1101,107,20,"k_t"],[1,1105,108,15,"x_2"],[1,1111,108,20,"x_3"],[1,1118,108,28,"cswap"],[1,1120,108,34,"swap"],[1,1122,108,40,"x_2"],[1,1124,108,45,"x_3"],[1,1130,109,15,"x_2"],[1,1134,109,20,"z_2"],[1,1136,109,25,"x_3"],[1,1140,109,30,"z_3"],[1,1143,109,38,"cswap"],[1,1145,109,44,"swap"],[1,1147,109,50,"z_2"],[1,1149,109,55,"z_3"],[1,1153,110,12,"swap"],[1,1155,110,19,"k_t"],[1,1157,111,12],[1,1163,111,18,"A"],[1,1165,111,22,"x_2"],[1,1167,111,28,"z_2"],[1,1169,112,18,"AA"],[1,1171,112,23,"modP"],[1,1173,112,28,"A"],[1,1175,112,32,"A"],[1,1178,113,18,"B"],[1,1180,113,22,"x_2"],[1,1182,113,28,"z_2"],[1,1184,114,18,"BB"],[1,1186,114,23,"modP"],[1,1188,114,28,"B"],[1,1190,114,32,"B"],[1,1193,115,18,"E"],[1,1195,115,22,"AA"],[1,1197,115,27,"BB"],[1,1199,116,18,"C"],[1,1201,116,22,"x_3"],[1,1203,116,28,"z_3"],[1,1205,118,18,"DA"],[1,1207,118,23,"modP"],[1,1210,117,22,"x_3"],[1,1212,117,28,"z_3"],[1,1215,118,32,"A"],[1,1218,119,18,"CB"],[1,1220,119,23,"modP"],[1,1222,119,28,"C"],[1,1224,119,32,"B"],[1,1227,120,18,"dacb"],[1,1229,120,25,"DA"],[1,1231,120,30,"CB"],[1,1233,121,18,"da_cb"],[1,1235,121,26,"DA"],[1,1237,121,31,"CB"],[1,1239,122,12,"x_3"],[1,1241,122,18,"modP"],[1,1243,122,23,"dacb"],[1,1245,122,30,"dacb"],[1,1248,123,12,"z_3"],[1,1250,123,18,"modP"],[1,1252,123,23,"x_1"],[1,1254,123,29,"modP"],[1,1256,123,34,"da_cb"],[1,1258,123,42,"da_cb"],[1,1262,124,12,"x_2"],[1,1264,124,18,"modP"],[1,1266,124,23,"AA"],[1,1268,124,28,"BB"],[1,1271,125,12,"z_2"],[1,1273,125,18,"modP"],[1,1275,125,23,"E"],[1,1278,125,28,"AA"],[1,1280,125,33,"modP"],[1,1282,125,38,"a24"],[1,1284,125,44,"E"],[1,1288,126,8],[1,1291,127,11,"x_2"],[1,1297,127,16,"x_3"],[1,1304,127,24,"cswap"],[1,1306,127,30,"swap"],[1,1308,127,36,"x_2"],[1,1310,127,41,"x_3"],[1,1316,128,11,"x_2"],[1,1320,128,16,"z_2"],[1,1322,128,21,"x_3"],[1,1326,128,26,"z_3"],[1,1329,128,34,"cswap"],[1,1331,128,40,"swap"],[1,1333,128,46,"z_2"],[1,1335,128,51,"z_3"],[1,1339,129,8],[1,1345,129,14,"z2"],[1,1347,129,19,"powPminus2"],[1,1349,129,30,"z_2"],[1,1352,130,8],[1,1359,130,15,"modP"],[1,1361,130,20,"x_2"],[1,1363,130,26,"z2"],[1,1365,131,4],[1,1366,132,4],[1,1372,132,10,"lengths"],[1,1374,132,20],[1,1375,133,8,"secretKey"],[1,1385,133,19,"fieldLen"],[1,1387,134,8,"publicKey"],[1,1397,134,19,"fieldLen"],[1,1399,135,8,"seed"],[1,1404,135,14,"fieldLen"],[1,1407,137,10,"randomSecretKey"],[1,1409,137,28,"randomSecretKey"],[1,1410,137,29,"seed"],[1,1412,137,36,"randomBytes_"],[1,1414,137,49,"fieldLen"],[1,1421,138,8],[1,1423,138,12,"utils_ts_1"],[1,1425,138,23,"abytes"],[1,1433,138,31,"seed"],[1,1435,138,37,"lengths"],[1,1437,138,45,"seed"],[1,1443,139,15,"seed"],[1,1446,149,4],[1,1452,149,11],[1,1453,150,8,"keygen"],[1,1460,141,4],[1,1469,141,20,"seed"],[1,1472,142,8],[1,1478,142,14,"secretKey"],[1,1480,142,26,"randomSecretKey"],[1,1482,142,42,"seed"],[1,1485,143,8],[1,1491,143,15],[1,1492,143,17,"secretKey"],[1,1504,143,28,"publicKey"],[1,1514,143,39,"scalarMultBase"],[1,1516,143,54,"secretKey"],[1,1519,144,4],[1,1521,151,8,"getSharedSecret"],[1,1537,151,25,"getSharedSecret"],[1,1538,151,26,"secretKey"],[1,1540,151,37,"publicKey"],[1,1544,151,51,"scalarMult"],[1,1546,151,62,"secretKey"],[1,1548,151,73,"publicKey"],[1,1551,152,8,"getPublicKey"],[1,1564,152,23,"secretKey"],[1,1567,152,37,"scalarMultBase"],[1,1569,152,52,"secretKey"],[1,1572,153,8,"scalarMult"],[1,1585,154,8,"scalarMultBase"],[1,1602,155,8,"utils"],[1,1608,145,18],[1,1609,146,8,"randomSecretKey"],[1,1627,147,8,"randomPrivateKey"],[1,1644,147,26,"randomSecretKey"],[1,1647,156,8,"GuBytes"],[1,1655,156,17,"GuBytes"],[1,1657,156,25,"slice"],[1,1665,157,8,"lengths"],[1,1675,159,0],[3,0,11,0],[3,6,11,6,"utils_ts_1"],[3,8,11,19,"require"],[3,10,11,26,"d"],[3,12,11,26],[3,16,12,6,"modular_ts_1"],[3,18,12,21,"require"],[3,20,12,28,"d"],[3,22,12,28],[3,26,13,6,"_0n"],[3,28,13,12,"BigInt"],[3,35,13,19],[3,38,14,6,"_1n"],[3,40,14,12,"BigInt"],[3,47,14,19],[3,50,15,6,"_2n"],[3,52,15,12,"BigInt"],[3,59,15,19],[3,62,16,0],[3,71,16,9,"validateOpts"],[3,73,16,22,"curve"],[3,76,21,4],[3,83,17,4],[3,85,17,8,"utils_ts_1"],[3,87,17,19,"_validateObject"],[3,104,17,36,"curve"],[3,106,17,43],[3,107,18,8,"adjustScalarBytes"],[3,125,18,27],[3,136,19,8,"powPminus2"],[3,147,19,20],[3,160,21,11,"Object"],[3,167,21,18,"freeze"],[3,174,21,25],[3,178,21,30,"curve"],[3,181,22,0],[3,182,159,1],[3,185]],"functionMap":{"names":["<global>","validateOpts","montgomery","modP","encodeU","decodeU","decodeScalar","scalarMult","scalarMultBase","cswap","montgomeryLadder","randomSecretKey","keygen","getSharedSecret","getPublicKey"],"mappings":"AAA;ACe;CDM;AEC;iBCuB,kCD;IEE;KFE;IGC;KHW;IIC;KJE;IKC;KLQ;IME;KNE;IOE;KPQ;IQO;KRoC;4BSM;KTG;IUC;KVG;yBWO,0DX;sBYC,wCZ;CFO"}},"type":"js/module"}]}