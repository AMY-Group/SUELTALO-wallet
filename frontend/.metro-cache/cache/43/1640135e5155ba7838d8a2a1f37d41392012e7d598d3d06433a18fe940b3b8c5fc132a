{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"@babel/runtime/helpers/objectSpread2","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0,"index":225},"end":{"line":13,"column":65,"index":290}}],"key":"SfRhzMj3Ex6qA89WTFEUm9Lj49A=","exportNames":["*"]}},{"name":"@babel/runtime/helpers/createForOfIteratorHelperLoose","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":14,"column":0,"index":291},"end":{"line":14,"column":100,"index":391}}],"key":"Y/2Rvrgl4aDxeJKdk1U58Vc2xw8=","exportNames":["*"]}},{"name":"fbjs/lib/invariant","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":15,"column":0,"index":392},"end":{"line":15,"column":43,"index":435}}],"key":"bGUa+dDG2WEhPiIlobT3urS95UE=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,e,d){'use strict';var t=r(d[0],\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var n=t(r(d[1],\"@babel/runtime/helpers/objectSpread2\")),s=t(r(d[2],\"@babel/runtime/helpers/createForOfIteratorHelperLoose\")),l=t(r(d[3],\"fbjs/lib/invariant\"));function o(t,n,s,l,o,c){if(u(s,l,o))return!0;var v=h(s,l,o);return 100*(t?v/o:v/c)>=n}function h(t,n,s){var l=Math.min(n,s)-Math.max(t,0);return Math.max(0,l)}function u(t,n,s){return t>=0&&n<=s&&n>t}e.default=class{constructor(t){void 0===t&&(t={viewAreaCoveragePercentThreshold:0}),this._hasInteracted=!1,this._timers=new Set,this._viewableIndices=[],this._viewableItems=new Map,this._config=t}dispose(){this._timers.forEach(clearTimeout)}computeViewableItems(t,n,s,h,u){var c=t.getItemCount(t.data),v=this._config,f=v.itemVisiblePercentThreshold,b=v.viewAreaCoveragePercentThreshold,_=null!=b,w=_?b:f;(0,l.default)(null!=w&&null!=f!=(null!=b),'Must set exactly one of itemVisiblePercentThreshold or viewAreaCoveragePercentThreshold');var I=[];if(0===c)return I;var p=-1,y=u||{first:0,last:c-1},T=y.first,V=y.last;if(V>=c)return console.warn('Invalid render range computing viewability '+JSON.stringify({renderRange:u,itemCount:c})),[];for(var C=T;C<=V;C++){var M=h(C,t);if(M){var P=M.offset-n,S=P+M.length;if(P<s&&S>0)p=C,o(_,w,P,S,s,M.length)&&I.push(C);else if(p>=0)break}}return I}onUpdate(t,n,s,l,o,h,u){var c=t.getItemCount(t.data);if((!this._config.waitForInteraction||this._hasInteracted)&&0!==c&&l(0,t)){var v=[];if(c&&(v=this.computeViewableItems(t,n,s,l,u)),this._viewableIndices.length!==v.length||!this._viewableIndices.every((t,n)=>t===v[n]))if(this._viewableIndices=v,this._config.minimumViewTime){var f=setTimeout(()=>{this._timers.delete(f),this._onUpdateSync(t,v,h,o)},this._config.minimumViewTime);this._timers.add(f)}else this._onUpdateSync(t,v,h,o)}}resetViewableIndices(){this._viewableIndices=[]}recordInteraction(){this._hasInteracted=!0}_onUpdateSync(t,l,o,h){l=l.filter(t=>this._viewableIndices.includes(t));for(var u,c=this._viewableItems,v=new Map(l.map(n=>{var s=h(n,!0,t);return[s.key,s]})),f=[],b=(0,s.default)(v);!(u=b()).done;){var _=u.value,w=_[0],I=_[1];c.has(w)||f.push(I)}for(var p,y=(0,s.default)(c);!(p=y()).done;){var T=p.value,V=T[0],C=T[1];v.has(V)||f.push((0,n.default)((0,n.default)({},C),{},{isViewable:!1}))}f.length>0&&(this._viewableItems=v,o({viewableItems:Array.from(v.values()),changed:f,viewabilityConfig:this._config}))}}});","lineCount":1,"map":[[1,28,11,0],[1,41,11,13],[1,45,11,13,"_interopRequireDefault"],[1,47,11,13,"r"],[1,49,11,13,"d"],[1,51,11,13],[1,102,11,13,"Object"],[1,109,11,13,"defineProperty"],[1,124,11,13,"e"],[1,126,11,13],[1,140,11,13,"value"],[1,147,11,13],[1,151,11,13,"e"],[1,153,11,13,"default"],[1,166,11,13],[1,168,13,0],[1,172,13,0,"_objectSpread2"],[1,174,13,0,"_interopRequireDefault"],[1,176,13,0,"r"],[1,178,13,0,"d"],[1,180,13,0],[1,224,14,0,"_createForOfIteratorHelperLoose2"],[1,226,14,0,"_interopRequireDefault"],[1,228,14,0,"r"],[1,230,14,0,"d"],[1,232,14,0],[1,293,15,0,"_invariant"],[1,295,15,0,"_interopRequireDefault"],[1,297,15,0,"r"],[1,299,15,0,"d"],[1,301,15,0],[1,327,190,0],[1,336,190,9,"_isViewable"],[1,338,190,21,"viewAreaMode"],[1,340,190,35,"viewablePercentThreshold"],[1,342,190,61,"top"],[1,344,190,66,"bottom"],[1,346,190,74,"viewportHeight"],[1,348,190,90,"itemLength"],[1,351,191,2],[1,354,191,6,"_isEntirelyVisible"],[1,356,191,25,"top"],[1,358,191,30,"bottom"],[1,360,191,38,"viewportHeight"],[1,363,192,4],[1,370,192,11],[1,372,194,4],[1,376,194,8,"pixels"],[1,378,194,17,"_getPixelsVisible"],[1,380,194,35,"top"],[1,382,194,40,"bottom"],[1,384,194,48,"viewportHeight"],[1,387,196,4],[1,394,195,18],[1,399,195,25,"viewAreaMode"],[1,401,195,40,"pixels"],[1,403,195,49,"viewportHeight"],[1,405,195,66,"pixels"],[1,407,195,75,"itemLength"],[1,411,196,22,"viewablePercentThreshold"],[1,412,198,0],[1,413,199,0],[1,422,199,9,"_getPixelsVisible"],[1,424,199,27,"top"],[1,426,199,32,"bottom"],[1,428,199,40,"viewportHeight"],[1,431,200,2],[1,435,200,6,"visibleHeight"],[1,437,200,22,"Math"],[1,442,200,27,"min"],[1,446,200,31,"bottom"],[1,448,200,39,"viewportHeight"],[1,451,200,57,"Math"],[1,456,200,62,"max"],[1,460,200,66,"top"],[1,462,200,71],[1,465,201,2],[1,472,201,9,"Math"],[1,477,201,14,"max"],[1,481,201,18],[1,483,201,21,"visibleHeight"],[1,485,202,0],[1,486,203,0],[1,495,203,9,"_isEntirelyVisible"],[1,497,203,28,"top"],[1,499,203,33,"bottom"],[1,501,203,41,"viewportHeight"],[1,504,204,2],[1,511,204,9,"top"],[1,514,204,16],[1,517,204,21,"bottom"],[1,520,204,31,"viewportHeight"],[1,523,204,49,"bottom"],[1,525,204,58,"top"],[1,526,205,0],[1,527,205,1,"e"],[1,529,205,1,"default"],[1,537,28,0],[1,543,29,2,"constructor"],[1,555,29,14,"config"],[1,563,30,19],[1,567,30,8,"config"],[1,571,31,6,"config"],[1,573,31,15],[1,574,32,8,"viewAreaCoveragePercentThreshold"],[1,607,32,42],[1,611,35,4,"this"],[1,616,35,9,"_hasInteracted"],[1,632,35,26],[1,634,36,4,"this"],[1,639,36,9,"_timers"],[1,647,36,19],[1,651,36,23,"Set"],[1,655,37,4,"this"],[1,660,37,9,"_viewableIndices"],[1,677,37,28],[1,680,38,4,"this"],[1,685,38,9,"_viewableItems"],[1,700,38,26],[1,704,38,30,"Map"],[1,708,39,4,"this"],[1,713,39,9,"_config"],[1,721,39,19,"config"],[1,722,40,2],[1,723,45,2,"dispose"],[1,733,49,4,"this"],[1,738,49,9,"_timers"],[1,746,49,17,"forEach"],[1,754,49,25,"clearTimeout"],[1,767,50,2],[1,768,55,2,"computeViewableItems"],[1,789,55,23,"props"],[1,791,55,30,"scrollOffset"],[1,793,55,44,"viewportHeight"],[1,795,55,60,"getFrameMetrics"],[1,797,57,2,"renderRange"],[1,800,58,4],[1,804,58,8,"itemCount"],[1,806,58,20,"props"],[1,808,58,26,"getItemCount"],[1,821,58,39,"props"],[1,823,58,45,"data"],[1,829,59,8,"_this$_config"],[1,831,59,24,"this"],[1,836,59,29,"_config"],[1,844,60,6,"itemVisiblePercentThreshold"],[1,846,60,36,"_this$_config"],[1,848,60,50,"itemVisiblePercentThreshold"],[1,876,61,6,"viewAreaCoveragePercentThreshold"],[1,878,61,41,"_this$_config"],[1,880,61,55,"viewAreaCoveragePercentThreshold"],[1,913,62,8,"viewAreaMode"],[1,915,62,59],[1,921,62,23,"viewAreaCoveragePercentThreshold"],[1,923,63,8,"viewablePercentThreshold"],[1,925,63,35,"viewAreaMode"],[1,927,63,50,"viewAreaCoveragePercentThreshold"],[1,929,63,85,"itemVisiblePercentThreshold"],[1,932,64,4],[1,934,64,4,"invariant"],[1,945,64,42],[1,951,64,14,"viewablePercentThreshold"],[1,954,64,81],[1,960,64,50,"itemVisiblePercentThreshold"],[1,964,64,127],[1,970,64,91,"viewAreaCoveragePercentThreshold"],[1,973,64,134],[1,1064,65,4],[1,1068,65,8,"viewableIndices"],[1,1070,65,26],[1,1073,66,4],[1,1076,66,22],[1,1080,66,8,"itemCount"],[1,1082,67,6],[1,1089,67,13,"viewableIndices"],[1,1091,69,4],[1,1095,69,8,"firstVisible"],[1,1098,69,24],[1,1100,70,8,"_ref"],[1,1102,70,15,"renderRange"],[1,1105,70,30],[1,1106,71,8,"first"],[1,1112,71,15],[1,1114,72,8,"last"],[1,1119,72,14,"itemCount"],[1,1121,72,26],[1,1124,74,6,"first"],[1,1126,74,14,"_ref"],[1,1128,74,19,"first"],[1,1134,75,6,"last"],[1,1136,75,13,"_ref"],[1,1138,75,18,"last"],[1,1143,76,4],[1,1146,76,8,"last"],[1,1149,76,16,"itemCount"],[1,1151,81,6],[1,1158,77,6,"console"],[1,1166,77,14,"warn"],[1,1171,77,19],[1,1217,77,67,"JSON"],[1,1222,77,72,"stringify"],[1,1232,77,82],[1,1233,78,8,"renderRange"],[1,1247,79,8,"itemCount"],[1,1262,81,13],[1,1265,83,4],[1,1269,83,9],[1,1273,83,13,"idx"],[1,1275,83,19,"first"],[1,1277,83,26,"idx"],[1,1280,83,33,"last"],[1,1282,83,39,"idx"],[1,1286,83,46],[1,1287,84,6],[1,1291,84,10,"metrics"],[1,1293,84,20,"getFrameMetrics"],[1,1295,84,36,"idx"],[1,1297,84,41,"props"],[1,1300,85,6],[1,1303,85,11,"metrics"],[1,1305,85,6],[1,1306,88,6],[1,1310,88,10,"top"],[1,1312,88,16,"metrics"],[1,1314,88,24,"offset"],[1,1321,88,33,"scrollOffset"],[1,1323,89,10,"bottom"],[1,1325,89,19,"top"],[1,1327,89,25,"metrics"],[1,1329,89,33,"length"],[1,1336,90,6],[1,1339,90,10,"top"],[1,1341,90,16,"viewportHeight"],[1,1344,90,34,"bottom"],[1,1346,90,43],[1,1348,91,8,"firstVisible"],[1,1350,91,23,"idx"],[1,1352,92,12,"_isViewable"],[1,1354,92,24,"viewAreaMode"],[1,1356,92,38,"viewablePercentThreshold"],[1,1358,92,64,"top"],[1,1360,92,69,"bottom"],[1,1362,92,77,"viewportHeight"],[1,1364,92,93,"metrics"],[1,1366,92,101,"length"],[1,1375,93,10,"viewableIndices"],[1,1377,93,26,"push"],[1,1382,93,31,"idx"],[1,1390,95,13],[1,1393,95,17,"firstVisible"],[1,1396,95,33],[1,1398,96,8],[1,1403,87,6],[1,1404,98,4],[1,1405,99,4],[1,1412,99,11,"viewableIndices"],[1,1413,100,2],[1,1414,106,2,"onUpdate"],[1,1423,106,11,"props"],[1,1425,106,18,"scrollOffset"],[1,1427,106,32,"viewportHeight"],[1,1429,106,48,"getFrameMetrics"],[1,1431,106,65,"createViewToken"],[1,1433,106,82,"onViewableItemsChanged"],[1,1435,108,2,"renderRange"],[1,1438,109,4],[1,1442,109,8,"itemCount"],[1,1444,109,20,"props"],[1,1446,109,26,"getItemCount"],[1,1459,109,39,"props"],[1,1461,109,45,"data"],[1,1467,110,4],[1,1472,110,8,"this"],[1,1477,110,13,"_config"],[1,1485,110,21,"waitForInteraction"],[1,1505,110,44,"this"],[1,1510,110,49,"_hasInteracted"],[1,1527,110,81],[1,1531,110,67,"itemCount"],[1,1534,110,87,"getFrameMetrics"],[1,1536,110,103],[1,1538,110,106,"props"],[1,1541,110,4],[1,1542,113,4],[1,1546,113,8,"viewableIndices"],[1,1548,113,26],[1,1551,117,4],[1,1554,114,8,"itemCount"],[1,1558,115,6,"viewableIndices"],[1,1560,115,24,"this"],[1,1565,115,29,"computeViewableItems"],[1,1586,115,50,"props"],[1,1588,115,57,"scrollOffset"],[1,1590,115,71,"viewportHeight"],[1,1592,115,87,"getFrameMetrics"],[1,1594,115,104,"renderRange"],[1,1598,117,8,"this"],[1,1603,117,13,"_viewableIndices"],[1,1620,117,30,"length"],[1,1629,117,41,"viewableIndices"],[1,1631,117,57,"length"],[1,1640,117,67,"this"],[1,1645,117,72,"_viewableIndices"],[1,1662,117,89,"every"],[1,1668,117,95],[1,1669,117,96,"v"],[1,1671,117,99,"ii"],[1,1675,117,106,"v"],[1,1679,117,112,"viewableIndices"],[1,1681,117,128,"ii"],[1,1685,123,4],[1,1688,122,4,"this"],[1,1693,122,9,"_viewableIndices"],[1,1710,122,28,"viewableIndices"],[1,1712,123,8,"this"],[1,1717,123,13,"_config"],[1,1725,123,21,"minimumViewTime"],[1,1741,123,38],[1,1742,124,6],[1,1746,124,10,"handle"],[1,1748,124,19,"setTimeout"],[1,1759,124,30],[1,1764,128,8,"this"],[1,1769,128,13,"_timers"],[1,1777,128,21,"delete"],[1,1784,128,28,"handle"],[1,1787,129,8,"this"],[1,1792,129,13,"_onUpdateSync"],[1,1806,129,27,"props"],[1,1808,129,34,"viewableIndices"],[1,1810,129,51,"onViewableItemsChanged"],[1,1812,129,75,"createViewToken"],[1,1816,130,9,"this"],[1,1821,130,14,"_config"],[1,1829,130,22,"minimumViewTime"],[1,1846,134,6,"this"],[1,1851,134,11,"_timers"],[1,1859,134,19,"add"],[1,1863,134,23,"handle"],[1,1865,135,4],[1,1871,136,6,"this"],[1,1876,136,11,"_onUpdateSync"],[1,1890,136,25,"props"],[1,1892,136,32,"viewableIndices"],[1,1894,136,49,"onViewableItemsChanged"],[1,1896,136,73,"createViewToken"],[1,1898,112,4],[1,1899,138,2],[1,1900,143,2,"resetViewableIndices"],[1,1923,144,4,"this"],[1,1928,144,9,"_viewableIndices"],[1,1945,144,28],[1,1947,145,2],[1,1948,150,2,"recordInteraction"],[1,1968,151,4,"this"],[1,1973,151,9,"_hasInteracted"],[1,1989,151,26],[1,1990,152,2],[1,1991,153,2,"_onUpdateSync"],[1,2005,153,16,"props"],[1,2007,153,23,"viewableIndicesToCheck"],[1,2009,153,47,"onViewableItemsChanged"],[1,2011,153,71,"createViewToken"],[1,2014,155,4,"viewableIndicesToCheck"],[1,2016,155,29,"viewableIndicesToCheck"],[1,2018,155,52,"filter"],[1,2025,155,59,"ii"],[1,2028,155,65,"this"],[1,2033,155,70,"_viewableIndices"],[1,2050,155,87,"includes"],[1,2059,155,96,"ii"],[1,2063,162,4],[1,2067,156,4],[1,2071,162,69,"_step"],[1,2073,156,8,"prevItems"],[1,2075,156,20,"this"],[1,2080,156,25,"_viewableItems"],[1,2095,157,8,"nextItems"],[1,2097,157,20],[1,2101,157,24,"Map"],[1,2105,157,28,"viewableIndicesToCheck"],[1,2107,157,51,"map"],[1,2111,157,55,"ii"],[1,2115,158,6],[1,2119,158,10,"viewable"],[1,2121,158,21,"createViewToken"],[1,2123,158,37,"ii"],[1,2126,158,41],[1,2128,158,47,"props"],[1,2131,159,6],[1,2137,159,13],[1,2138,159,14,"viewable"],[1,2140,159,23,"key"],[1,2144,159,28,"viewable"],[1,2150,161,8,"changed"],[1,2152,161,18],[1,2155,162,13,"_iterator"],[1,2158,162,25],[1,2160,162,25,"_createForOfIteratorHelperLoose"],[1,2171,162,57,"nextItems"],[1,2176,162,78,"_step"],[1,2178,162,86,"_iterator"],[1,2183,162,99,"done"],[1,2189,162,106],[1,2190,163,6],[1,2194,163,10,"_step$value"],[1,2196,163,24,"_step"],[1,2198,163,30,"value"],[1,2204,164,8,"key"],[1,2206,164,14,"_step$value"],[1,2208,164,26],[1,2211,165,8,"viewable"],[1,2213,165,19,"_step$value"],[1,2215,165,31],[1,2218,166,11,"prevItems"],[1,2220,166,21,"has"],[1,2224,166,25,"key"],[1,2228,167,8,"changed"],[1,2230,167,16,"push"],[1,2235,167,21,"viewable"],[1,2237,169,4],[1,2238,170,4],[1,2242,170,9],[1,2246,170,70,"_step2"],[1,2248,170,13,"_iterator2"],[1,2251,170,26],[1,2253,170,26,"_createForOfIteratorHelperLoose"],[1,2264,170,58,"prevItems"],[1,2269,170,80,"_step2"],[1,2271,170,89,"_iterator2"],[1,2276,170,103,"done"],[1,2282,170,110],[1,2283,171,6],[1,2287,171,10,"_step2$value"],[1,2289,171,25,"_step2"],[1,2291,171,32,"value"],[1,2297,172,8,"_key"],[1,2299,172,15,"_step2$value"],[1,2301,172,28],[1,2304,173,8,"_viewable"],[1,2306,173,20,"_step2$value"],[1,2308,173,33],[1,2311,174,11,"nextItems"],[1,2313,174,21,"has"],[1,2317,174,25,"_key"],[1,2321,175,8,"changed"],[1,2323,175,16,"push"],[1,2329,175,21],[1,2331,175,21,"_objectSpread"],[1,2343,175,35],[1,2345,175,35,"_objectSpread"],[1,2356,175,49],[1,2357,175,50],[1,2359,175,53,"_viewable"],[1,2362,175,65],[1,2363,175,66],[1,2365,175,69],[1,2366,176,10,"isViewable"],[1,2378,176,22],[1,2382,179,4],[1,2383,180,8,"changed"],[1,2385,180,16,"length"],[1,2392,180,25],[1,2396,181,6,"this"],[1,2401,181,11,"_viewableItems"],[1,2416,181,28,"nextItems"],[1,2418,182,6,"onViewableItemsChanged"],[1,2420,182,29],[1,2421,183,8,"viewableItems"],[1,2435,183,23,"Array"],[1,2441,183,29,"from"],[1,2446,183,34,"nextItems"],[1,2448,183,44,"values"],[1,2458,184,8,"changed"],[1,2468,185,8,"viewabilityConfig"],[1,2486,185,27,"this"],[1,2491,185,32,"_config"],[1,2501,188,2],[1,2503,206,32],[1,2506]],"functionMap":{"names":["<global>","ViewabilityHelper","ViewabilityHelper#constructor","ViewabilityHelper#dispose","ViewabilityHelper#computeViewableItems","ViewabilityHelper#onUpdate","_viewableIndices.every$argument_0","setTimeout$argument_0","ViewabilityHelper#resetViewableIndices","ViewabilityHelper#recordInteraction","ViewabilityHelper#_onUpdateSync","viewableIndicesToCheck.filter$argument_0","viewableIndicesToCheck.map$argument_0","_isViewable","_getPixelsVisible","_isEntirelyVisible"],"mappings":"AAA;AC2B;ECC;GDW;EEK;GFK;EGK;GH6C;EIM;+FCW,oCD;8BEO;OFM;GJQ;EOK;GPE;EQK;GRE;ESC;2DCE,wCD;uDEE;KFG;GT4B;CDC;AaC;CbQ;AcC;CdG;AeC;CfE"}},"type":"js/module"}]}