{"dependencies":[{"name":"../utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":275},"end":{"line":8,"column":125,"index":400}}],"key":"dGswK136diHRCgUa8xpQUn/UMbc=","exportNames":["*"]}},{"name":"./modular.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":401},"end":{"line":9,"column":35,"index":436}}],"key":"9k+FDNYf3zXm2KDVSy5nBT9psY4=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,\"__esModule\",{value:!0}),e.montgomery=function(y){const B=s(y),{P:l,type:f,adjustScalarBytes:I,powPminus2:_,randomBytes:b}=B,x='x25519'===f;if(!x&&'x448'!==f)throw new Error('invalid type');const p=b||t.randomBytes,v=x?255:448,K=x?32:56,w=x?BigInt(9):BigInt(5),P=x?BigInt(121665):BigInt(39081),j=x?u**BigInt(254):u**BigInt(447),E=x?BigInt(8)*u**BigInt(251)-c:BigInt(4)*u**BigInt(445)-c,S=j+E+c,h=t=>(0,n.mod)(t,l),L=M(w);function M(n){return(0,t.numberToBytesLE)(h(n),K)}function O(n){const o=(0,t.ensureBytes)('u coordinate',n,K);return x&&(o[31]&=127),h((0,t.bytesToNumberLE)(o))}function T(n){return(0,t.bytesToNumberLE)(I((0,t.ensureBytes)('scalar',n,K)))}function k(t,n){const c=z(O(n),T(t));if(c===o)throw new Error('invalid private or public key received');return M(c)}function N(t){return k(t,L)}function R(t,n,o){const c=h(t*(n-o));return{x_2:n=h(n-c),x_3:o=h(o+c)}}function z(n,u){(0,t.aInRange)('u',n,o,l),(0,t.aInRange)('scalar',u,j,S);const s=u,y=n;let B=c,f=o,I=n,b=c,x=o;for(let t=BigInt(v-1);t>=o;t--){const n=s>>t&c;x^=n,({x_2:B,x_3:I}=R(x,B,I)),({x_2:f,x_3:b}=R(x,f,b)),x=n;const o=B+f,u=h(o*o),l=B-f,_=h(l*l),p=u-_,v=I+b,K=h((I-b)*o),w=h(v*l),j=K+w,E=K-w;I=h(j*j),b=h(y*h(E*E)),B=h(u*_),f=h(p*(u+h(P*p)))}({x_2:B,x_3:I}=R(x,B,I)),({x_2:f,x_3:b}=R(x,f,b));const p=_(f);return h(B*p)}const G={secretKey:K,publicKey:K,seed:K},q=(n=p(K))=>((0,t.abytes)(n,G.seed),n);return{keygen:function(t){const n=q(t);return{secretKey:n,publicKey:N(n)}},getSharedSecret:(t,n)=>k(t,n),getPublicKey:t=>N(t),scalarMult:k,scalarMultBase:N,utils:{randomSecretKey:q,randomPrivateKey:q},GuBytes:L.slice(),lengths:G}};var t=r(d[0]),n=r(d[1]);\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nconst o=BigInt(0),c=BigInt(1),u=BigInt(2);function s(n){return(0,t._validateObject)(n,{adjustScalarBytes:'function',powPminus2:'function'}),Object.freeze({...n})}});","lineCount":3,"map":[[1,90,20,7],[1,99,20,27,"curveDef"],[1,102,21,4],[1,108,21,10,"CURVE"],[1,110,21,18,"validateOpts"],[1,112,21,31,"curveDef"],[1,116,22,10,"P"],[1,118,22,12,"P"],[1,120,22,13,"type"],[1,125,22,15,"type"],[1,127,22,19,"adjustScalarBytes"],[1,145,22,21,"adjustScalarBytes"],[1,147,22,38,"powPminus2"],[1,158,22,40,"powPminus2"],[1,160,22,52,"randomBytes"],[1,172,22,65,"rand"],[1,175,22,74,"CURVE"],[1,177,23,10,"is25519"],[1,179,23,29],[1,190,23,20,"type"],[1,192,24,4],[1,196,24,9,"is25519"],[1,199,24,29],[1,208,24,20,"type"],[1,210,25,8],[1,216,25,14],[1,220,25,18,"Error"],[1,226,25,24],[1,242,26,4],[1,248,26,10,"randomBytes_"],[1,250,26,25,"rand"],[1,253,26,33,"randomBytes"],[1,267,27,10,"montgomeryBits"],[1,269,27,27,"is25519"],[1,271,27,37],[1,275,27,43],[1,279,28,10,"fieldLen"],[1,281,28,21,"is25519"],[1,283,28,31],[1,286,28,36],[1,289,29,10,"Gu"],[1,291,29,15,"is25519"],[1,293,29,25,"BigInt"],[1,300,29,32],[1,303,29,37,"BigInt"],[1,310,29,44],[1,313,34,10,"a24"],[1,315,34,16,"is25519"],[1,317,34,26,"BigInt"],[1,324,34,33],[1,332,34,43,"BigInt"],[1,339,34,50],[1,346,38,10,"minScalar"],[1,348,38,22,"is25519"],[1,350,38,32,"_2n"],[1,353,38,39,"BigInt"],[1,360,38,46],[1,365,38,53,"_2n"],[1,368,38,60,"BigInt"],[1,375,38,67],[1,380,39,10,"maxAdded"],[1,382,39,21,"is25519"],[1,384,40,10,"BigInt"],[1,391,40,17],[1,394,40,22,"_2n"],[1,397,40,29,"BigInt"],[1,404,40,36],[1,409,40,43,"_1n"],[1,411,41,10,"BigInt"],[1,418,41,17],[1,421,41,22,"_2n"],[1,424,41,29,"BigInt"],[1,431,41,36],[1,436,41,43,"_1n"],[1,438,42,10,"maxScalar"],[1,440,42,22,"minScalar"],[1,442,42,34,"maxAdded"],[1,444,42,45,"_1n"],[1,446,43,10,"modP"],[1,448,43,18,"n"],[1,452,43,24],[1,454,43,24,"mod"],[1,461,43,28,"n"],[1,463,43,31,"P"],[1,466,44,10,"GuBytes"],[1,468,44,20,"encodeU"],[1,470,44,28,"Gu"],[1,473,45,4],[1,482,45,13,"encodeU"],[1,484,45,21,"u"],[1,487,46,8],[1,494,46,15],[1,496,46,15,"numberToBytesLE"],[1,515,46,31,"modP"],[1,517,46,36,"u"],[1,520,46,40,"fieldLen"],[1,522,47,4],[1,523,48,4],[1,532,48,13,"decodeU"],[1,534,48,21,"u"],[1,537,49,8],[1,543,49,14,"_u"],[1,546,49,19],[1,548,49,19,"ensureBytes"],[1,563,49,31],[1,578,49,47,"u"],[1,580,49,50,"fieldLen"],[1,583,58,8],[1,590,52,12,"is25519"],[1,594,53,12,"_u"],[1,596,53,15],[1,601,53,22],[1,606,58,15,"modP"],[1,609,58,20],[1,611,58,20,"bytesToNumberLE"],[1,630,58,36,"_u"],[1,633,59,4],[1,634,60,4],[1,643,60,13,"decodeScalar"],[1,645,60,26,"scalar"],[1,648,61,8],[1,655,61,15],[1,657,61,15,"bytesToNumberLE"],[1,676,61,31,"adjustScalarBytes"],[1,679,61,49],[1,681,61,49,"ensureBytes"],[1,696,61,61],[1,705,61,71,"scalar"],[1,707,61,79,"fieldLen"],[1,711,62,4],[1,712,63,4],[1,721,63,13,"scalarMult"],[1,723,63,24,"scalar"],[1,725,63,32,"u"],[1,728,64,8],[1,734,64,14,"pu"],[1,736,64,19,"montgomeryLadder"],[1,738,64,36,"decodeU"],[1,740,64,44,"u"],[1,743,64,48,"decodeScalar"],[1,745,64,61,"scalar"],[1,749,68,8],[1,752,68,12,"pu"],[1,756,68,19,"_0n"],[1,758,69,12],[1,764,69,18],[1,768,69,22,"Error"],[1,774,69,28],[1,816,70,8],[1,823,70,15,"encodeU"],[1,825,70,23,"pu"],[1,827,71,4],[1,828,73,4],[1,837,73,13,"scalarMultBase"],[1,839,73,28,"scalar"],[1,842,74,8],[1,849,74,15,"scalarMult"],[1,851,74,26,"scalar"],[1,853,74,34,"GuBytes"],[1,855,75,4],[1,856,77,4],[1,865,77,13,"cswap"],[1,867,77,19,"swap"],[1,869,77,25,"x_2"],[1,871,77,30,"x_3"],[1,874,81,8],[1,880,81,14,"dummy"],[1,882,81,22,"modP"],[1,884,81,27,"swap"],[1,887,81,35,"x_2"],[1,889,81,41,"x_3"],[1,893,84,8],[1,899,84,15],[1,900,84,17,"x_2"],[1,904,82,8,"x_2"],[1,906,82,14,"modP"],[1,908,82,19,"x_2"],[1,910,82,25,"dummy"],[1,913,84,22,"x_3"],[1,917,83,8,"x_3"],[1,919,83,14,"modP"],[1,921,83,19,"x_3"],[1,923,83,25,"dummy"],[1,926,85,4],[1,927,92,4],[1,936,92,13,"montgomeryLadder"],[1,938,92,30,"u"],[1,940,92,33,"scalar"],[1,944,93,8],[1,946,93,8,"aInRange"],[1,958,93,17],[1,962,93,22,"u"],[1,964,93,25,"_0n"],[1,966,93,30,"P"],[1,970,94,8],[1,972,94,8,"aInRange"],[1,984,94,17],[1,993,94,27,"scalar"],[1,995,94,35,"minScalar"],[1,997,94,46,"maxScalar"],[1,1000,95,8],[1,1006,95,14,"k"],[1,1008,95,18,"scalar"],[1,1010,96,14,"x_1"],[1,1012,96,20,"u"],[1,1014,97,8],[1,1018,97,12,"x_2"],[1,1020,97,18,"_1n"],[1,1022,98,12,"z_2"],[1,1024,98,18,"_0n"],[1,1026,99,12,"x_3"],[1,1028,99,18,"u"],[1,1030,100,12,"z_3"],[1,1032,100,18,"_1n"],[1,1034,101,12,"swap"],[1,1036,101,19,"_0n"],[1,1038,102,8],[1,1042,102,13],[1,1046,102,17,"t"],[1,1048,102,21,"BigInt"],[1,1055,102,28,"montgomeryBits"],[1,1057,102,45],[1,1060,102,49,"t"],[1,1063,102,54,"_0n"],[1,1065,102,59,"t"],[1,1069,102,64],[1,1070,103,12],[1,1076,103,18,"k_t"],[1,1078,103,25,"k"],[1,1081,103,30,"t"],[1,1083,103,35,"_1n"],[1,1085,104,12,"swap"],[1,1088,104,20,"k_t"],[1,1092,105,15,"x_2"],[1,1098,105,20,"x_3"],[1,1105,105,28,"cswap"],[1,1107,105,34,"swap"],[1,1109,105,40,"x_2"],[1,1111,105,45,"x_3"],[1,1117,106,15,"x_2"],[1,1121,106,20,"z_2"],[1,1123,106,25,"x_3"],[1,1127,106,30,"z_3"],[1,1130,106,38,"cswap"],[1,1132,106,44,"swap"],[1,1134,106,50,"z_2"],[1,1136,106,55,"z_3"],[1,1140,107,12,"swap"],[1,1142,107,19,"k_t"],[1,1144,108,12],[1,1150,108,18,"A"],[1,1152,108,22,"x_2"],[1,1154,108,28,"z_2"],[1,1156,109,18,"AA"],[1,1158,109,23,"modP"],[1,1160,109,28,"A"],[1,1162,109,32,"A"],[1,1165,110,18,"B"],[1,1167,110,22,"x_2"],[1,1169,110,28,"z_2"],[1,1171,111,18,"BB"],[1,1173,111,23,"modP"],[1,1175,111,28,"B"],[1,1177,111,32,"B"],[1,1180,112,18,"E"],[1,1182,112,22,"AA"],[1,1184,112,27,"BB"],[1,1186,113,18,"C"],[1,1188,113,22,"x_3"],[1,1190,113,28,"z_3"],[1,1192,115,18,"DA"],[1,1194,115,23,"modP"],[1,1197,114,22,"x_3"],[1,1199,114,28,"z_3"],[1,1202,115,32,"A"],[1,1205,116,18,"CB"],[1,1207,116,23,"modP"],[1,1209,116,28,"C"],[1,1211,116,32,"B"],[1,1214,117,18,"dacb"],[1,1216,117,25,"DA"],[1,1218,117,30,"CB"],[1,1220,118,18,"da_cb"],[1,1222,118,26,"DA"],[1,1224,118,31,"CB"],[1,1226,119,12,"x_3"],[1,1228,119,18,"modP"],[1,1230,119,23,"dacb"],[1,1232,119,30,"dacb"],[1,1235,120,12,"z_3"],[1,1237,120,18,"modP"],[1,1239,120,23,"x_1"],[1,1241,120,29,"modP"],[1,1243,120,34,"da_cb"],[1,1245,120,42,"da_cb"],[1,1249,121,12,"x_2"],[1,1251,121,18,"modP"],[1,1253,121,23,"AA"],[1,1255,121,28,"BB"],[1,1258,122,12,"z_2"],[1,1260,122,18,"modP"],[1,1262,122,23,"E"],[1,1265,122,28,"AA"],[1,1267,122,33,"modP"],[1,1269,122,38,"a24"],[1,1271,122,44,"E"],[1,1275,123,8],[1,1278,124,11,"x_2"],[1,1284,124,16,"x_3"],[1,1291,124,24,"cswap"],[1,1293,124,30,"swap"],[1,1295,124,36,"x_2"],[1,1297,124,41,"x_3"],[1,1303,125,11,"x_2"],[1,1307,125,16,"z_2"],[1,1309,125,21,"x_3"],[1,1313,125,26,"z_3"],[1,1316,125,34,"cswap"],[1,1318,125,40,"swap"],[1,1320,125,46,"z_2"],[1,1322,125,51,"z_3"],[1,1326,126,8],[1,1332,126,14,"z2"],[1,1334,126,19,"powPminus2"],[1,1336,126,30,"z_2"],[1,1339,127,8],[1,1346,127,15,"modP"],[1,1348,127,20,"x_2"],[1,1350,127,26,"z2"],[1,1352,128,4],[1,1353,129,4],[1,1359,129,10,"lengths"],[1,1361,129,20],[1,1362,130,8,"secretKey"],[1,1372,130,19,"fieldLen"],[1,1374,131,8,"publicKey"],[1,1384,131,19,"fieldLen"],[1,1386,132,8,"seed"],[1,1391,132,14,"fieldLen"],[1,1394,134,10,"randomSecretKey"],[1,1396,134,28,"randomSecretKey"],[1,1397,134,29,"seed"],[1,1399,134,36,"randomBytes_"],[1,1401,134,49,"fieldLen"],[1,1408,135,8],[1,1410,135,8,"abytes"],[1,1420,135,15,"seed"],[1,1422,135,21,"lengths"],[1,1424,135,29,"seed"],[1,1430,136,15,"seed"],[1,1433,146,4],[1,1439,146,11],[1,1440,147,8,"keygen"],[1,1447,138,4],[1,1456,138,20,"seed"],[1,1459,139,8],[1,1465,139,14,"secretKey"],[1,1467,139,26,"randomSecretKey"],[1,1469,139,42,"seed"],[1,1472,140,8],[1,1478,140,15],[1,1479,140,17,"secretKey"],[1,1491,140,28,"publicKey"],[1,1501,140,39,"scalarMultBase"],[1,1503,140,54,"secretKey"],[1,1506,141,4],[1,1508,148,8,"getSharedSecret"],[1,1524,148,25,"getSharedSecret"],[1,1525,148,26,"secretKey"],[1,1527,148,37,"publicKey"],[1,1531,148,51,"scalarMult"],[1,1533,148,62,"secretKey"],[1,1535,148,73,"publicKey"],[1,1538,149,8,"getPublicKey"],[1,1551,149,23,"secretKey"],[1,1554,149,37,"scalarMultBase"],[1,1556,149,52,"secretKey"],[1,1559,150,8,"scalarMult"],[1,1572,151,8,"scalarMultBase"],[1,1589,152,8,"utils"],[1,1595,142,18],[1,1596,143,8,"randomSecretKey"],[1,1614,144,8,"randomPrivateKey"],[1,1631,144,26,"randomSecretKey"],[1,1634,153,8,"GuBytes"],[1,1642,153,17,"GuBytes"],[1,1644,153,25,"slice"],[1,1652,154,8,"lengths"],[1,1662,156,0],[1,1664,8,0],[1,1668,8,0,"_utils"],[1,1670,8,0,"r"],[1,1672,8,0,"d"],[1,1674,8,0],[1,1678,9,0,"_modular"],[1,1680,9,0,"r"],[1,1682,9,0,"d"],[1,1684,9,0],[3,0,10,0],[3,6,10,6,"_0n"],[3,8,10,12,"BigInt"],[3,15,10,19],[3,18,11,6,"_1n"],[3,20,11,12,"BigInt"],[3,27,11,19],[3,30,12,6,"_2n"],[3,32,12,12,"BigInt"],[3,39,12,19],[3,42,13,0],[3,51,13,9,"validateOpts"],[3,53,13,22,"curve"],[3,56,18,4],[3,63,14,4],[3,65,14,4,"_validateObject"],[3,84,14,20,"curve"],[3,86,14,27],[3,87,15,8,"adjustScalarBytes"],[3,105,15,27],[3,116,16,8,"powPminus2"],[3,127,16,20],[3,140,18,11,"Object"],[3,147,18,18,"freeze"],[3,154,18,25],[3,158,18,30,"curve"],[3,161,19,0],[3,162,156,1],[3,165]],"functionMap":{"names":["<global>","validateOpts","montgomery","modP","encodeU","decodeU","decodeScalar","scalarMult","scalarMultBase","cswap","montgomeryLadder","randomSecretKey","keygen","getSharedSecret","getPublicKey"],"mappings":"AAA;ACY;CDM;OEC;iBCuB,gBD;IEE;KFE;IGC;KHW;IIC;KJE;IKC;KLQ;IME;KNE;IOE;KPQ;IQO;KRoC;4BSM;KTG;IUC;KVG;yBWO,0DX;sBYC,wCZ;CFO"}},"type":"js/module"}]}