{"dependencies":[{"name":"@solana/buffer-layout","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"QwywkJpcZkKLkjXs9E7VxOaHAHQ=","exportNames":["*"]}},{"name":"@solana/buffer-layout-utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":61,"index":114}}],"key":"uY07c2hRI0N+OVJYRD373wbUopw=","exportNames":["*"]}},{"name":"../extensionType.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":115},"end":{"line":3,"column":70,"index":185}}],"key":"9B9SsrL0iX24r6c12s5npw5ZP78=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.TransferFeeConfigLayout = exports.TransferFeeAmountLayout = exports.TRANSFER_FEE_CONFIG_SIZE = exports.TRANSFER_FEE_AMOUNT_SIZE = exports.ONE_IN_BASIS_POINTS = exports.MAX_FEE_BASIS_POINTS = void 0;\n  exports.calculateEpochFee = calculateEpochFee;\n  exports.calculateFee = calculateFee;\n  exports.getEpochFee = getEpochFee;\n  exports.getTransferFeeAmount = getTransferFeeAmount;\n  exports.getTransferFeeConfig = getTransferFeeConfig;\n  exports.transferFeeLayout = transferFeeLayout;\n  var _bufferLayout = require(_dependencyMap[0], \"@solana/buffer-layout\");\n  var _bufferLayoutUtils = require(_dependencyMap[1], \"@solana/buffer-layout-utils\");\n  var _extensionType = require(_dependencyMap[2], \"../extensionType.js\");\n  const MAX_FEE_BASIS_POINTS = exports.MAX_FEE_BASIS_POINTS = 10000;\n  const ONE_IN_BASIS_POINTS = exports.ONE_IN_BASIS_POINTS = BigInt(MAX_FEE_BASIS_POINTS);\n  /** Buffer layout for de/serializing a transfer fee */\n  function transferFeeLayout(property) {\n    return (0, _bufferLayout.struct)([(0, _bufferLayoutUtils.u64)('epoch'), (0, _bufferLayoutUtils.u64)('maximumFee'), (0, _bufferLayout.u16)('transferFeeBasisPoints')], property);\n  }\n  /** Calculate the transfer fee */\n  function calculateFee(transferFee, preFeeAmount) {\n    const transferFeeBasisPoints = transferFee.transferFeeBasisPoints;\n    if (transferFeeBasisPoints === 0 || preFeeAmount === BigInt(0)) {\n      return BigInt(0);\n    } else {\n      const numerator = preFeeAmount * BigInt(transferFeeBasisPoints);\n      const rawFee = (numerator + ONE_IN_BASIS_POINTS - BigInt(1)) / ONE_IN_BASIS_POINTS;\n      const fee = rawFee > transferFee.maximumFee ? transferFee.maximumFee : rawFee;\n      return BigInt(fee);\n    }\n  }\n  /** Buffer layout for de/serializing a transfer fee config extension */\n  const TransferFeeConfigLayout = exports.TransferFeeConfigLayout = (0, _bufferLayout.struct)([(0, _bufferLayoutUtils.publicKey)('transferFeeConfigAuthority'), (0, _bufferLayoutUtils.publicKey)('withdrawWithheldAuthority'), (0, _bufferLayoutUtils.u64)('withheldAmount'), transferFeeLayout('olderTransferFee'), transferFeeLayout('newerTransferFee')]);\n  const TRANSFER_FEE_CONFIG_SIZE = exports.TRANSFER_FEE_CONFIG_SIZE = TransferFeeConfigLayout.span;\n  /** Get the fee for given epoch */\n  function getEpochFee(transferFeeConfig, epoch) {\n    if (epoch >= transferFeeConfig.newerTransferFee.epoch) {\n      return transferFeeConfig.newerTransferFee;\n    } else {\n      return transferFeeConfig.olderTransferFee;\n    }\n  }\n  /** Calculate the fee for the given epoch and input amount */\n  function calculateEpochFee(transferFeeConfig, epoch, preFeeAmount) {\n    const transferFee = getEpochFee(transferFeeConfig, epoch);\n    return calculateFee(transferFee, preFeeAmount);\n  }\n  /** Buffer layout for de/serializing */\n  const TransferFeeAmountLayout = exports.TransferFeeAmountLayout = (0, _bufferLayout.struct)([(0, _bufferLayoutUtils.u64)('withheldAmount')]);\n  const TRANSFER_FEE_AMOUNT_SIZE = exports.TRANSFER_FEE_AMOUNT_SIZE = TransferFeeAmountLayout.span;\n  function getTransferFeeConfig(mint) {\n    const extensionData = (0, _extensionType.getExtensionData)(_extensionType.ExtensionType.TransferFeeConfig, mint.tlvData);\n    if (extensionData !== null) {\n      return TransferFeeConfigLayout.decode(extensionData);\n    } else {\n      return null;\n    }\n  }\n  function getTransferFeeAmount(account) {\n    const extensionData = (0, _extensionType.getExtensionData)(_extensionType.ExtensionType.TransferFeeAmount, account.tlvData);\n    if (extensionData !== null) {\n      return TransferFeeAmountLayout.decode(extensionData);\n    } else {\n      return null;\n    }\n  }\n});","lineCount":68,"map":[[12,2,1,0],[12,6,1,0,"_bufferLayout"],[12,19,1,0],[12,22,1,0,"require"],[12,29,1,0],[12,30,1,0,"_dependencyMap"],[12,44,1,0],[13,2,2,0],[13,6,2,0,"_bufferLayoutUtils"],[13,24,2,0],[13,27,2,0,"require"],[13,34,2,0],[13,35,2,0,"_dependencyMap"],[13,49,2,0],[14,2,3,0],[14,6,3,0,"_extensionType"],[14,20,3,0],[14,23,3,0,"require"],[14,30,3,0],[14,31,3,0,"_dependencyMap"],[14,45,3,0],[15,2,4,7],[15,8,4,13,"MAX_FEE_BASIS_POINTS"],[15,28,4,33],[15,31,4,33,"exports"],[15,38,4,33],[15,39,4,33,"MAX_FEE_BASIS_POINTS"],[15,59,4,33],[15,62,4,36],[15,67,4,41],[16,2,5,7],[16,8,5,13,"ONE_IN_BASIS_POINTS"],[16,27,5,32],[16,30,5,32,"exports"],[16,37,5,32],[16,38,5,32,"ONE_IN_BASIS_POINTS"],[16,57,5,32],[16,60,5,35,"BigInt"],[16,66,5,41],[16,67,5,42,"MAX_FEE_BASIS_POINTS"],[16,87,5,62],[16,88,5,63],[17,2,6,0],[18,2,7,7],[18,11,7,16,"transferFeeLayout"],[18,28,7,33,"transferFeeLayout"],[18,29,7,34,"property"],[18,37,7,42],[18,39,7,44],[19,4,8,4],[19,11,8,11],[19,15,8,11,"struct"],[19,35,8,17],[19,37,8,18],[19,38,8,19],[19,42,8,19,"u64"],[19,64,8,22],[19,66,8,23],[19,73,8,30],[19,74,8,31],[19,76,8,33],[19,80,8,33,"u64"],[19,102,8,36],[19,104,8,37],[19,116,8,49],[19,117,8,50],[19,119,8,52],[19,123,8,52,"u16"],[19,140,8,55],[19,142,8,56],[19,166,8,80],[19,167,8,81],[19,168,8,82],[19,170,8,84,"property"],[19,178,8,92],[19,179,8,93],[20,2,9,0],[21,2,10,0],[22,2,11,7],[22,11,11,16,"calculateFee"],[22,23,11,28,"calculateFee"],[22,24,11,29,"transferFee"],[22,35,11,40],[22,37,11,42,"preFeeAmount"],[22,49,11,54],[22,51,11,56],[23,4,12,4],[23,10,12,10,"transferFeeBasisPoints"],[23,32,12,32],[23,35,12,35,"transferFee"],[23,46,12,46],[23,47,12,47,"transferFeeBasisPoints"],[23,69,12,69],[24,4,13,4],[24,8,13,8,"transferFeeBasisPoints"],[24,30,13,30],[24,35,13,35],[24,36,13,36],[24,40,13,40,"preFeeAmount"],[24,52,13,52],[24,57,13,57,"BigInt"],[24,63,13,63],[24,64,13,64],[24,65,13,65],[24,66,13,66],[24,68,13,68],[25,6,14,8],[25,13,14,15,"BigInt"],[25,19,14,21],[25,20,14,22],[25,21,14,23],[25,22,14,24],[26,4,15,4],[26,5,15,5],[26,11,16,9],[27,6,17,8],[27,12,17,14,"numerator"],[27,21,17,23],[27,24,17,26,"preFeeAmount"],[27,36,17,38],[27,39,17,41,"BigInt"],[27,45,17,47],[27,46,17,48,"transferFeeBasisPoints"],[27,68,17,70],[27,69,17,71],[28,6,18,8],[28,12,18,14,"rawFee"],[28,18,18,20],[28,21,18,23],[28,22,18,24,"numerator"],[28,31,18,33],[28,34,18,36,"ONE_IN_BASIS_POINTS"],[28,53,18,55],[28,56,18,58,"BigInt"],[28,62,18,64],[28,63,18,65],[28,64,18,66],[28,65,18,67],[28,69,18,71,"ONE_IN_BASIS_POINTS"],[28,88,18,90],[29,6,19,8],[29,12,19,14,"fee"],[29,15,19,17],[29,18,19,20,"rawFee"],[29,24,19,26],[29,27,19,29,"transferFee"],[29,38,19,40],[29,39,19,41,"maximumFee"],[29,49,19,51],[29,52,19,54,"transferFee"],[29,63,19,65],[29,64,19,66,"maximumFee"],[29,74,19,76],[29,77,19,79,"rawFee"],[29,83,19,85],[30,6,20,8],[30,13,20,15,"BigInt"],[30,19,20,21],[30,20,20,22,"fee"],[30,23,20,25],[30,24,20,26],[31,4,21,4],[32,2,22,0],[33,2,23,0],[34,2,24,7],[34,8,24,13,"TransferFeeConfigLayout"],[34,31,24,36],[34,34,24,36,"exports"],[34,41,24,36],[34,42,24,36,"TransferFeeConfigLayout"],[34,65,24,36],[34,68,24,39],[34,72,24,39,"struct"],[34,92,24,45],[34,94,24,46],[34,95,25,4],[34,99,25,4,"publicKey"],[34,127,25,13],[34,129,25,14],[34,157,25,42],[34,158,25,43],[34,160,26,4],[34,164,26,4,"publicKey"],[34,192,26,13],[34,194,26,14],[34,221,26,41],[34,222,26,42],[34,224,27,4],[34,228,27,4,"u64"],[34,250,27,7],[34,252,27,8],[34,268,27,24],[34,269,27,25],[34,271,28,4,"transferFeeLayout"],[34,288,28,21],[34,289,28,22],[34,307,28,40],[34,308,28,41],[34,310,29,4,"transferFeeLayout"],[34,327,29,21],[34,328,29,22],[34,346,29,40],[34,347,29,41],[34,348,30,1],[34,349,30,2],[35,2,31,7],[35,8,31,13,"TRANSFER_FEE_CONFIG_SIZE"],[35,32,31,37],[35,35,31,37,"exports"],[35,42,31,37],[35,43,31,37,"TRANSFER_FEE_CONFIG_SIZE"],[35,67,31,37],[35,70,31,40,"TransferFeeConfigLayout"],[35,93,31,63],[35,94,31,64,"span"],[35,98,31,68],[36,2,32,0],[37,2,33,7],[37,11,33,16,"getEpochFee"],[37,22,33,27,"getEpochFee"],[37,23,33,28,"transferFeeConfig"],[37,40,33,45],[37,42,33,47,"epoch"],[37,47,33,52],[37,49,33,54],[38,4,34,4],[38,8,34,8,"epoch"],[38,13,34,13],[38,17,34,17,"transferFeeConfig"],[38,34,34,34],[38,35,34,35,"newerTransferFee"],[38,51,34,51],[38,52,34,52,"epoch"],[38,57,34,57],[38,59,34,59],[39,6,35,8],[39,13,35,15,"transferFeeConfig"],[39,30,35,32],[39,31,35,33,"newerTransferFee"],[39,47,35,49],[40,4,36,4],[40,5,36,5],[40,11,37,9],[41,6,38,8],[41,13,38,15,"transferFeeConfig"],[41,30,38,32],[41,31,38,33,"olderTransferFee"],[41,47,38,49],[42,4,39,4],[43,2,40,0],[44,2,41,0],[45,2,42,7],[45,11,42,16,"calculateEpochFee"],[45,28,42,33,"calculateEpochFee"],[45,29,42,34,"transferFeeConfig"],[45,46,42,51],[45,48,42,53,"epoch"],[45,53,42,58],[45,55,42,60,"preFeeAmount"],[45,67,42,72],[45,69,42,74],[46,4,43,4],[46,10,43,10,"transferFee"],[46,21,43,21],[46,24,43,24,"getEpochFee"],[46,35,43,35],[46,36,43,36,"transferFeeConfig"],[46,53,43,53],[46,55,43,55,"epoch"],[46,60,43,60],[46,61,43,61],[47,4,44,4],[47,11,44,11,"calculateFee"],[47,23,44,23],[47,24,44,24,"transferFee"],[47,35,44,35],[47,37,44,37,"preFeeAmount"],[47,49,44,49],[47,50,44,50],[48,2,45,0],[49,2,46,0],[50,2,47,7],[50,8,47,13,"TransferFeeAmountLayout"],[50,31,47,36],[50,34,47,36,"exports"],[50,41,47,36],[50,42,47,36,"TransferFeeAmountLayout"],[50,65,47,36],[50,68,47,39],[50,72,47,39,"struct"],[50,92,47,45],[50,94,47,46],[50,95,47,47],[50,99,47,47,"u64"],[50,121,47,50],[50,123,47,51],[50,139,47,67],[50,140,47,68],[50,141,47,69],[50,142,47,70],[51,2,48,7],[51,8,48,13,"TRANSFER_FEE_AMOUNT_SIZE"],[51,32,48,37],[51,35,48,37,"exports"],[51,42,48,37],[51,43,48,37,"TRANSFER_FEE_AMOUNT_SIZE"],[51,67,48,37],[51,70,48,40,"TransferFeeAmountLayout"],[51,93,48,63],[51,94,48,64,"span"],[51,98,48,68],[52,2,49,7],[52,11,49,16,"getTransferFeeConfig"],[52,31,49,36,"getTransferFeeConfig"],[52,32,49,37,"mint"],[52,36,49,41],[52,38,49,43],[53,4,50,4],[53,10,50,10,"extensionData"],[53,23,50,23],[53,26,50,26],[53,30,50,26,"getExtensionData"],[53,61,50,42],[53,63,50,43,"ExtensionType"],[53,91,50,56],[53,92,50,57,"TransferFeeConfig"],[53,109,50,74],[53,111,50,76,"mint"],[53,115,50,80],[53,116,50,81,"tlvData"],[53,123,50,88],[53,124,50,89],[54,4,51,4],[54,8,51,8,"extensionData"],[54,21,51,21],[54,26,51,26],[54,30,51,30],[54,32,51,32],[55,6,52,8],[55,13,52,15,"TransferFeeConfigLayout"],[55,36,52,38],[55,37,52,39,"decode"],[55,43,52,45],[55,44,52,46,"extensionData"],[55,57,52,59],[55,58,52,60],[56,4,53,4],[56,5,53,5],[56,11,54,9],[57,6,55,8],[57,13,55,15],[57,17,55,19],[58,4,56,4],[59,2,57,0],[60,2,58,7],[60,11,58,16,"getTransferFeeAmount"],[60,31,58,36,"getTransferFeeAmount"],[60,32,58,37,"account"],[60,39,58,44],[60,41,58,46],[61,4,59,4],[61,10,59,10,"extensionData"],[61,23,59,23],[61,26,59,26],[61,30,59,26,"getExtensionData"],[61,61,59,42],[61,63,59,43,"ExtensionType"],[61,91,59,56],[61,92,59,57,"TransferFeeAmount"],[61,109,59,74],[61,111,59,76,"account"],[61,118,59,83],[61,119,59,84,"tlvData"],[61,126,59,91],[61,127,59,92],[62,4,60,4],[62,8,60,8,"extensionData"],[62,21,60,21],[62,26,60,26],[62,30,60,30],[62,32,60,32],[63,6,61,8],[63,13,61,15,"TransferFeeAmountLayout"],[63,36,61,38],[63,37,61,39,"decode"],[63,43,61,45],[63,44,61,46,"extensionData"],[63,57,61,59],[63,58,61,60],[64,4,62,4],[64,5,62,5],[64,11,63,9],[65,6,64,8],[65,13,64,15],[65,17,64,19],[66,4,65,4],[67,2,66,0],[68,0,66,1],[68,3]],"functionMap":{"names":["<global>","transferFeeLayout","calculateFee","getEpochFee","calculateEpochFee","getTransferFeeConfig","getTransferFeeAmount"],"mappings":"AAA;OCM;CDE;OEE;CFW;OGW;CHO;OIE;CJG;OKI;CLQ;OMC;CNQ"}},"type":"js/module"}]}